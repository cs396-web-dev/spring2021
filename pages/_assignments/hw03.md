---
layout: assignment-two-column
title: "Web Client: JS Implementation"
abbreviation: HW3
type: homework
due_date: 2021-05-12
ordering: 3
draft: 1
points: 15
---

## Introduction
In this assignment, you are going to build part of a graphical user interface (i.e. web client) to interact your Doctor Who REST API, using HTML, CSS, and Vanilla JavaScript. Here are some links to relevant lectures that cover the technologies you will be using:

* [Intro to Client-Side Web Programming](lectures/lecture07)
* [Fetch API](../lectures/lecture09)
* [Templates & Event Handlers](../lectures/lecture08)

### A Few Guidelines

* You may work with a partner (same collaboration policy as in [HW 1 & 2](hw01/)).
* You may **NOT** use any JavaScript frameworks. Everything must be completed using "Vanilla" JavaScript, HTML, and CSS.
* We will **NOT** be evaluating you on the CSS / layout / styling in this assigment, while we've made some CSS choices in the demo video, you are welcome to display things however you like. 


### Demo Video
<iframe src="https://northwestern.hosted.panopto.com/Panopto/Pages/Embed.aspx?id=6e25a2be-686c-45b5-b721-ad19013584db&autoplay=false&offerviewer=true&showtitle=true&showbrand=false&start=0&interactivity=all" height="405" width="720" style="border: 1px solid #464646;" allowfullscreen allow="autoplay"></iframe>

## Part 1: Set Up Your Files
Download `doctor-who-ui.zip`, which is a modified version of the `hw02-cs396.zip`. 

### Changelog
The files you're downloading are the same as the ones in HW2, with the following exceptions:
1. There is a new version of the `config/data.json` file. The file has the same doctors and companions, but new data fields have been added:
   * The Doctor and Companion objects now have an `image_url` (to store an image of each doctor).
   * The Doctor object also has an `ordering` field (so that we can easily sort the doctors chronologically).
2. The `src/schemas/Doctor.js` and `src/schemas/Companion.js` schemas have been updated to accommodate the (optional) new fields.
3. The `index.js` is now listening for static media requests in the `public` directory, which is controlled by the following line of code: 
   * `app.use(express.static('public'))`

### Configure your new server
Please complete the following steps to configure your new server:
1. Copy your `.env` file into the root of your `doctor-who-ui` directory.
2. Copy your completed `routes.js` from homework 2 into the `src` directory (replacing the current one).
3. Install the dependencies `npm install`
4. Populate your DB: `npm run populate`
5. Run your server: `npm start`
6. Run your tests again (they should all still pass if they were passing before). Note that there are a few tests that may failing because of the modified schemas. You will fix this in Part 3.1 (below).

{:#tasks}

## Part 2: Back-End (Server) Updates
Please modify your routes.js file as follows:

### 1. Update POST and PATCH routes so that they accept the new attributes (1 point)

Since the `Doctor.js` and `Companion.js` schemas have changed, you may need to update the following `POST` and `PATCH` endpoints (depending how you implemented them in HW2)...

* /doctors (POST)
* /doctors/:id (PATCH)
* /companions (POST)
* /companions/:id (PATCH)

...so that they allow an optional `image_url` attribute to be saved to the database. In addition, for the doctors endpoints, an optional `ordering` attribute should also be accepted.

### 2. Add sorting to the /doctors GET endpoint (0.5 points)
You will also modify the `/doctors` GET endpoint (in `routes.js`) so that it will return the list of doctors sorted by the `ordering` attribute. So make sure you append the [.sort()](https://mongoosejs.com/docs/api/query.html#query_Query-sort) function to the end of you `find()` query so that the results are returned in order:

```js
Doctor
    .find({})
    .sort('ordering')  // sort by the "ordering" attribute
    .then(...)
```

### 3. Verify your changes
When you're done, run the tests and they should all pass!


## Part 3: Front-End (Client) Updates
In the `public` directory, there are three files -- `editor.html`, `style.css` and `main.js` -- which will serve as the "front end" of your Doctor Who website. To view what this web page looks like in your web browser, navigate to: <a href="http://localhost:8081/editor.html" target="_blank">http://localhost:8081/editor.html</a>.

Open `main.js` and `editor.html` in your code editor and complete the following tasks:

### 1. Display all of the doctors (2 Points)
When the page loads, fetch all of the doctors from your <a href="http://localhost:8081/doctors" target="_blank">http://localhost:8081/doctors</a> endpoint, and display the names of all of the doctors in the left-hand panel. We suggest that you render the doctors as a list of anchor tags. There is an example of how to do something like this in <a href="https://github.com/cs396-web-dev/spring2021/tree/main/course-files/lectures/lecture09/public/answers/01_get_advanced" target="_blank">Lecture 9</a>, but feel free to do it your way.

### 2. Display individual doctor and associated companions (4 Points)
When the user clicks on one of the doctors, display the following:
* A panel showing the doctor's name, picture, and seasons (2 points).
* A panel showing all of the companions that traveled with the doctor (2 points).

Note that this will require 2 fetch requests to be issued simultaneously: one to `/doctors/:id` and one to `/doctors/:id/companions`. See the demo video for an example.

### 3. Add the ability to create a new doctor (6 Points)
* [1 pt] Add a "create doctor" button to your UI. When the user clicks this button, the UI should show a form on the screen that allows the user to input the data to create a new doctor.
* If the user clicks the save button. Check the data the user entered and make sure it is valid.
   * [2 pts] If it is:
        * [1 pt] Issue a `POST` request to the `/doctors/` endpoint with the data the user inputted.
        * [0.5 pts] Redraw the left-hand panel so that the new doctor is now in the list.
        * [0.5 pts] Hide the "detail" panels (only the doctor list should be showing).
   * [2 pts] If it isn't, display a message to the user asking them to fix the data.
* [1 pts] If the user clicks the cancel button, hide the "detail" panels (only the doctor list should be showing).

Here is sample code for an HTML form that you're welcome to use:

```html
<form>
    <!-- Name -->
    <label for="name">Name</label>
    <input type="text" id="name">

    <!-- Seasons -->
    <label for="seasons">Seasons</label>
    <input type="text" id="seasons">

    <!-- Ordering -->
    <label for="ordering">Ordering</label>
    <input type="text" id="ordering">

    <!-- Image -->
    <label for="image_url">Image</label>
    <input type="text" id="image_url">

    <!-- Buttons -->
    <button class="btn btn-main" id="create">Save</button>
    <button class="btn" id="cancel">Cancel</button>
</form>
```

### 4. Add the ability to edit an existing doctor (6 points)
* [1 pt] Inside of the panel showing the doctor's name, picture, and seasons, add an "Edit" button. When the user clicks this button, the UI should show a form on the screen that is pre-populated with the doctor's existing data (which the user will be able to edit).
* If the user clicks the save button. Check the data the user entered and make sure it is valid.
   * [2 pts] If it is:
        * [1 pt] Issue a `PATCH` request to the `/doctors/:id` endpoint with the data the user inputted.
        * [0.5 pt] Redraw the left-hand panel so that any updates to the doctor are reflected in the list.
        * [0.5 pt] Show the "detail panel" with the edited doctor's updated information.
   * [2 pts] If it isn't, display a message to the user asking them to fix the data.
* [1 pt] If the user clicks the cancel button, show the "detail panel" with the doctor's information.

### 5. UI to Delete a Doctor (3 Points)
* [1 pt] Inside of the panel showing the doctor's name, picture, and seasons, add an "Edit" button. When the user clicks this button, prompt the user with a confirmation message, asking them whether they're sure.
  * [2 pts] If they say "OK"

### 6. Extra Credit (Up to X Points)
* Allow the user to edit a companion (see video below)
* Allow the user to delete a companion (see video below)
* Allow the user to add a new a companion for the specific doctor (see video below)
* Allow the user to favorite a doctor or companion
* Allow the user to view their favorite doctors / companions

Here is a <a href="https://northwestern.hosted.panopto.com/Panopto/Pages/Viewer.aspx?id=e7950863-a35f-460c-8b58-ad1901358508" target="_blank">demo of (some of the) optional functionality</a>.

## Part 3: Deploy your app to Heroku (2 Points)
You will use the same process as used in [Homework 2](hw02#part4), except you will be committing and deploying your files in your `doctor-who-ui` folder.

## What to Turn In
### Verify that you're done

{:.checkbox-list}
<table>
    <tr>
        <th>1.5 pts</th>
        <td>routes.js</td>
        <td>The routes.js file was updated according to the instructions in part 1 (run the tests and they should pass). 
        </td>
    </tr>
    <tr>
        <th>0 pts</th>
        <td>Doctor List</td>
            <td>A list of doctors appears on the left-hand side when the page loads. 
        </td>
    </tr>
    <tr>
        <th>0 pts</th>
        <td>Doctor Detail</td>
        <td>When you click any of the doctors, details about the doctor and the doctor's companions appear in the main panel (see video). 
        </td>
    </tr>
    <tr>
        <th>0 pts</th>
        <td>Create Doctor</td>
        <td> 
            <ul>
                <li>Clicking the add doctor button shows a "Create Doctor" form.</li>
                <li>There is data validation.</li>
                <li>When the form is submitted, a valid `POST` request is sent to the /`doctors/` endpoint. </li>
            </ul>
        </td>
    </tr>
    <tr>
        <th>0 pts</th>
        <td>Edit Doctor</td>
        <td> 
            <ul>
                <li>Clicking the edit button next to the doctor shows a pre-populated "Edit" form.</li>
                <li>There is data validation. </li>
                <li>When the form is submitted, a valid `PATCH` request is sent to the /`doctors/:id` endpoint.</li>
            </ul>
        </td>
    </tr>
    <tr>
        <th>0 pts</th>
        <td>Delete Doctor</td>
        <td>
            <ul>
                <li>Uses the confirm function to make sure the user really wants to do this. </li>
                <li>If confirmed, a valid `DELETE` request is sent to the /`doctors/:id` endpoint.</li>
            </ul>
        </td>
    </tr>
    <tr>
        <th>0 pts</th>
        <td>Feedback / Error Handling<br>For the `PATCH`, `POST`, and `DELETE` requests:</td>
        <td>
            <ul>
                <li>
                    If a success response is received back from the server, the doctor list (left-hand side) should be updated to reflect the change.
                </li>
                <li>
                    If an error response is received, give the user some feedback as to what went wrong. 
                </li>
            </ul>
        </td>
    </tr>
</table>


### Submit to Canvas
When you're done, you should submit the following to Canvas:

1. A zip file that contains your `public` directory and your updated `routes.js` file.
1. A link to your live Heroku web server (just paste the link in as a comment on Canvas).
1. A list of your collaborators, if applicable (just list them in the comments section of Canvas).
1. Also, tell us if you attempted the extra credit (totally optional).
